package dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;

import javax.sql.DataSource;

import dto.Donation;
import dto.Exchange;

public class MypageDao {
	
	DataSource dataSource;
	public MypageDao(DataSource dataSource) {
		this.dataSource = dataSource;
	}
	//마이페이지 기부 목록 가져오기
	public ArrayList<Donation> myDonationList(String id) {
		ArrayList<Donation> mydonationList = new ArrayList<Donation>();
		Connection conn = null;
		PreparedStatement pstmt = null;
		ResultSet rs = null;
		String sql = "select * from donation where id=?";
		try {
			conn = dataSource.getConnection();
			pstmt = conn.prepareStatement(sql);
			pstmt.setString(1, id);
			rs = pstmt.executeQuery();
			while (rs.next()) {
				Donation mydonation = new Donation();
				mydonation.setNo(rs.getInt("no"));
				mydonation.setTalent1(rs.getString("talent1"));
				mydonation.setTalent2(rs.getString("talent2"));
				mydonation.setPeople(rs.getInt("people"));
				mydonation.setId(rs.getString("id"));
				mydonation.setSubject(rs.getString("subject"));
				mydonation.setContent(rs.getString("content"));
				mydonation.setLocation(rs.getString("location"));
				mydonation.setClosing_date(rs.getString("closing_date"));
				mydonationList.add(mydonation);
			}
		} catch(Exception e) {
			e.printStackTrace();
		} finally {
			try {
				if (rs != null) rs.close();
				if (pstmt != null) pstmt.close();
				if (conn != null) conn.close();
			} catch(Exception e) {}
		}
		return mydonationList;
	}
	//마이페이지 교환 목록 가져오기 
	public ArrayList<Exchange> myExchangeList(String id) {
		ArrayList<Exchange> myexchangeList = new ArrayList<Exchange>();
		Connection conn = null;
		PreparedStatement pstmt = null;
		ResultSet rs = null;
		String sql = "select * from exchange where id=?";
		try {
			conn = dataSource.getConnection();
			pstmt = conn.prepareStatement(sql);
			pstmt.setString(1, id);
			rs = pstmt.executeQuery();
			while (rs.next()) {
				Exchange myexchange = new Exchange();
				myexchange.setNo(rs.getInt("no"));
				myexchange.setGive_talent1(rs.getString("give_talent1"));
				myexchange.setGive_talent2(rs.getString("give_talent2"));
				myexchange.setWish_talent1(rs.getString("wish_talent1"));
				myexchange.setWish_talent2(rs.getString("wish_talent2"));
				myexchange.setId(rs.getString("id"));
				myexchange.setSubject(rs.getString("subject"));
				myexchange.setContent(rs.getString("content"));
				myexchange.setLocation(rs.getString("location"));
				myexchange.setClosing_date(rs.getString("closing_date"));
				myexchangeList.add(myexchange);
			}
		} catch(Exception e) {
			e.printStackTrace();
		} finally {
			try {
				if (rs != null) rs.close();
				if (pstmt != null) pstmt.close();
				if (conn != null) conn.close();
			} catch(Exception e) {}
		}
		return myexchangeList;
	}
}
